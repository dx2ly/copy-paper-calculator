<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>复印纸加工自动计算</title>
  <style>
    body { font-family: sans-serif; max-width: 500px; margin: auto; padding: 20px; }
    h2 { text-align: center; }

    label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
    }

    label span {
      flex: 1;
    }

    input, select {
      width: 120px;
      padding: 6px;
      margin-left: 10px;
    }

    .output {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
      color: green;
    }

    .note {
      font-size: 12px;
      color: gray;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>复印纸加工自动计算</h2>

  <label><span>吨价（元/吨）：</span><input type="number" id="tonPrice" value="4900"></label>
  <label><span>实际克数（g）：</span><input type="number" id="weight" value="68"></label>
  <label><span>实际张数：</span><input type="number" id="sheets" value="395"></label>
  <label><span>包数：</span>
    <select id="packs">
      <option value="5">5 包</option>
      <option value="8">8 包</option>
    </select>
  </label>
  <label><span>内包成本（默认0.22）：</span><input type="number" id="innerCost" value="0.22" step="0.01"></label>
  <label><span>箱盖（黄传韵0.4）：</span><input type="number" id="boxTop" value="0.65" step="0.01"></label>
  <label><span>箱底（黄传韵0.8 红淮星0.95）：</span><input type="number" id="boxBottom" value="1.15" step="0.01"></label>

  <div class="output">成品单价（箱）含代工费：<span id="result">0.00</span> 元</div>
  <div class="output">成品单价（箱）含运费：<span id="resultWithFreight">0.00</span> 元</div>

  <div class="note">加工费固定为 100 元。自动计算基于 Excel 提供公式。</div>

  <script>
    function setDefaultPackagingCosts(packCount) {
      const boxTopInput = document.getElementById('boxTop');
      const boxBottomInput = document.getElementById('boxBottom');
      if (packCount === 5) {
        boxTopInput.value = "0.65";
        boxBottomInput.value = "1.15";
      } else if (packCount === 8) {
        boxTopInput.value = "0.90";
        boxBottomInput.value = "1.75";
      }
    }

    function calculate() {
      const A = parseFloat(document.getElementById('tonPrice').value) || 0;
      const B = 100;
      const D = parseFloat(document.getElementById('weight').value) || 0;
      const E = parseFloat(document.getElementById('sheets').value) || 0;
      const F = parseInt(document.getElementById('packs').value) || 0;
      const G = parseFloat(document.getElementById('innerCost').value) || 0;
      const H = parseFloat(document.getElementById('boxTop').value) || 0;
      const I = parseFloat(document.getElementById('boxBottom').value) || 0;

      const base = (A + B) / 452 / 70 / 500;
      const result = base * D * E * F + G * F + H + I;
      const freight = F === 5 ? 0.2825 : F === 8 ? 0.4531 : 0;
      const resultWithFreight = result + freight;

      document.getElementById('result').textContent = result.toFixed(4);
      document.getElementById('resultWithFreight').textContent = resultWithFreight.toFixed(4);
    }

    document.querySelectorAll('input, select').forEach(el => {
      el.addEventListener('input', calculate);
    });

    document.getElementById('packs').addEventListener('change', (e) => {
      const packCount = parseInt(e.target.value, 10);
      setDefaultPackagingCosts(packCount);
      calculate();
    });

    // 初始化
    setDefaultPackagingCosts(5);
    calculate();
  </script>
</body>
</html>
